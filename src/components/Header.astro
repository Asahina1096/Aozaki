---
// 纯静态 Astro 组件，无 React 依赖
// 使用 SVG 图标代替 lucide-react，减少 JS 包体积
import { css } from "../../styled-system/css";

const headerClass = css({
  position: "sticky",
  top: "0",
  zIndex: "50",
  w: "full",
  borderBottom: "1px solid",
  borderColor: "border",
  bg: "background",
  opacity: "0.95",
  backdropFilter: "blur(8px)",
});

const containerClass = css({
  maxW: "1400px",
  mx: "auto",
  px: "8",
  display: "flex",
  h: "16",
  alignItems: "center",
  justifyContent: "space-between",
});

const titleClass = css({
  fontSize: "2xl",
  fontWeight: "bold",
  bgGradient: "to-r",
  gradientFrom: "primary",
  gradientVia: "primary",
  gradientTo: "primary",
  bgClip: "text",
  color: "transparent",
});

const buttonClass = css({
  display: "inline-flex",
  alignItems: "center",
  justifyContent: "center",
  whiteSpace: "nowrap",
  rounded: "md",
  fontSize: "sm",
  fontWeight: "medium",
  transition: "colors",
  h: "10",
  w: "10",
  _hover: {
    bg: "accent",
    color: "accent.foreground",
  },
  _focusVisible: {
    outline: "none",
    ringWidth: "2",
    ringColor: "ring",
    ringOffsetWidth: "2",
  },
  _disabled: {
    pointerEvents: "none",
    opacity: "0.5",
  },
});
---

<header class={headerClass}>
  <div class={containerClass}>
    <div class={css({ display: "flex", alignItems: "center", gap: "3" })}>
      <h1 class={titleClass}>
        Aozaki
      </h1>
    </div>

    <div class={css({ display: "flex", alignItems: "center", gap: "2" })}>
      <button
        id="theme-toggle"
        class={buttonClass}
        aria-label="切换主题"
      >
        <!-- Sun Icon (visible in light mode) -->
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="20"
          height="20"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class={css({ _dark: { display: "none" } })}
        >
          <circle cx="12" cy="12" r="4"></circle>
          <path d="M12 2v2"></path>
          <path d="M12 20v2"></path>
          <path d="m4.93 4.93 1.41 1.41"></path>
          <path d="m17.66 17.66 1.41 1.41"></path>
          <path d="M2 12h2"></path>
          <path d="M20 12h2"></path>
          <path d="m6.34 17.66-1.41 1.41"></path>
          <path d="m19.07 4.93-1.41 1.41"></path>
        </svg>
        <!-- Moon Icon (visible in dark mode) -->
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="20"
          height="20"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class={css({ display: "none", _dark: { display: "block" } })}
        >
          <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path>
        </svg>
      </button>
    </div>
  </div>
</header>

<script>
  // 主题切换逻辑
  function initThemeToggle() {
    const toggle = document.getElementById("theme-toggle");
    if (!toggle) return;

    toggle.addEventListener("click", () => {
      document.documentElement.classList.toggle("dark");
    });
  }

  // 初始化
  initThemeToggle();

  // 支持 Astro View Transitions
  document.addEventListener("astro:page-load", initThemeToggle);
</script>
